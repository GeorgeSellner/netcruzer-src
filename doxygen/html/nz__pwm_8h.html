<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Netcruzer Library API: netcruzer/lib/nz_pwm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Netcruzer Library API
   &#160;<span id="projectnumber">V2.03</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nz__pwm_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nz_pwm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Simple and efficient functions for PWM configuration and usage.  
<a href="#details">More...</a></p>

<p><a href="nz__pwm_8h_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple and efficient functions for PWM configuration and usage. </p>
<dl class="section author"><dt>Author</dt><dd><a href="www.modtronix.com">Modtronix Engineering</a> </dd></dl>
<dl class="section user"><dt>Compiler:</dt><dd>MPLAB XC16 compiler</dd></dl>
<h1><a class="anchor" id="nz_pwm_desc"></a>
Description</h1>
<p>Simple and efficient functions for PWM configuration and usage. The SBC66 Netcruzer boards have 9 PWM channels. They can be assigned to any of the Relocatable Ports. For the location of the Relocatable Ports, see <a href="http://netcruzer.com/nzdoc-sbc66-ports/">http://netcruzer.com/nzdoc-sbc66-ports/</a> To use a PWM channel, first call pwmOpenDefault() function, and then pwmSetDutyCycle() and pwmSetPercent() functions to set PWM duty cycle or percentage.</p>
<p>When channel is configured for 16kHz (default), duty cycle percentages can be changed in 0.1% steps. For example, pwmSetPercent(2, 1.5) will set PWM 2 to 1.5% duty cycle. In this mode, 0.1% is not possible, and will result in a duty cycle of 0%. From 0.2% all values work as expected.</p>
<p>When channel is configured for 160kHz, duty cycle percentages can be changed in 1% steps. For example, pwmSetPercent(1, 5) will set PWM 1 to 5% duty cycle. In this mode, 1% is not possible, and will result in a duty cycle of 0%. From 2% all values work as expected.</p>
<p>When channel is configured for 1.6kHz, duty cycle percentages can be changed in 0.01% steps. For example, pwmSetPercent(1, 1.42) will set PWM 1 to 1.42% duty cycle. In this mode, 0.01% is not possible, and will result in a duty cycle of 0%. From 0.02% all values work as expected.</p>
<h2>Details</h2>
<p>Each PWM module has it's own timer, implemented as a 16-bit timer. The clock for each timer is configured by this module to be 16MHz, giving a 62.5ns period. Each PWM channel has two registers, OCxRS (period) and OCxR (duty cycle). The PWM timer will count from 0 upwards, and when equal to the value of OCxRS, will reset to 0 on next clock. For example, when OCxRS=999, it will count from 0-999 (1000 steps). This determines the frequency(period) of the PWM channel, and is calculated (1/((OCxRS+1)*62.5ns)). For example, a OCxRS value of 999 gives a frequency of 16kHz.</p>
<p>The value of the OCxR register determines the duty cycle of the PWM. When the PWM timer resets to 0, the output goes high (if OCxR!=0). It will remain high until OCxR = PWM timer, and then on the NEXT clock it will go low. This means that the PWM output can NOT be configured to be high for a single clock, but minimum 2 clocks.</p>
<ul>
<li>Setting OCxR to 0, will result in a duty cycle of 0% (output permanently 0V)</li>
<li>Setting OCxR equal to OCxRS, will result in a duty cycle of 100% (output permanently 3.3V)</li>
</ul>
<h2><a class="anchor" id="nz_pwm_conf"></a>
Configuration</h2>
<p>The following defines are used to configure this module, and should be placed in projdefs.h. Note that all items marked [-DEFAULT-] are defaults, and do not have to be placed in projdefs.h if they contain desired configuration! For details, see <a class="el" href="group__info__conf__proj.html">Project Configuration</a>. </p>
<div class="fragment"><div class="line"><span class="comment">// *********************************************************************</span></div>
<div class="line"><span class="comment">// --------------- nz_pwm Configuration (from nz_pwm.h) ----------------</span></div>
<div class="line"><span class="comment">// *********************************************************************</span></div>
<div class="line"><span class="comment">//#define    NZ_PWM_DISABLE                  //Don&#39;t manage PWM - PWM is enabled by default</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Set default frequencies for PWM 1 to 9. Some predefined values are PWM_FREQ_1600HZ, PWM_FREQ_16KHZ, PWM_FREQ_80KHZ and PWM_FREQ_160KHZ</span></div>
<div class="line"><span class="comment">//If using custom value, ensure it is a multiple of 100. This ensures pwmxSetPercent() functions works efficiently.</span></div>
<div class="line"><span class="preprocessor">#define PWM1_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM2_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM3_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM4_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM5_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM6_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM7_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PWM8_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
<div class="line"><span class="preprocessor">#define PWM9_FREQ       PWM_FREQ_16KHZ     //PWM frequency is 16kHz</span></div>
</div><!-- fragment --><h1><a class="anchor" id="nz_pwm_lic"></a>
Software License Agreement</h1>
<p>The software supplied herewith is owned by Modtronix Engineering, and is protected under applicable copyright laws. The software supplied herewith is intended and supplied to you, the Company customer, for use solely and exclusively on products manufactured by Modtronix Engineering. The code may be modified and can be used free of charge for commercial and non commercial applications. All rights are reserved. Any use in violation of the foregoing restrictions may subject the user to criminal sanctions under applicable laws, as well as to civil liability for the breach of the terms and conditions of this license.</p>
<p>THIS SOFTWARE IS PROVIDED IN AN 'AS IS' CONDITION. NO WARRANTIES, WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT, IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.</p>
<p>File History</p>
<p>2010-06-06, David Hosken (DH):</p>
<ul>
<li>Initial version for 24FJ256GB110 at 32MHz </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0497715779ca99cb1134d5ce544966ba.html">netcruzer</a></li><li class="navelem"><a class="el" href="dir_285a68def6f82363136d1caaa0fe0051.html">lib</a></li><li class="navelem"><a class="el" href="nz__pwm_8h.html">nz_pwm.h</a></li>
    <li class="footer">Generated on Tue Dec 9 2014 15:08:19 for Netcruzer Library API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
