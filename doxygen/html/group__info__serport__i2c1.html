<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Netcruzer: I2C 1 Serial Port</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Netcruzer
   &#160;<span id="projectnumber">V2.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__info__serport__i2c1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">I2C 1 Serial Port<div class="ingroups"><a class="el" href="group__info__serport.html">Serial Ports</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="info_serport_i2c1_intro"></a>
Introduction</h1>
<p>This module is implemented in the serportI2C1.c and serportI2C1.h files. It makes the I2C 1 Serial Port available for writing and reading data to and from. It is configured at 400kbits/sec by default. It is interrupt based, and all processing is handled in the background by the interrupt service routine. A transmit and receive circular buffer is used for sending and receiving data. All data added to the transmit serial buffer is written out to the I2C 1 port, and all data received is added to the receive buffer.</p>
<h2><a class="anchor" id="info_serport_i2c1_write"></a>
Writing I2C Messages</h2>
<p>To send a message via the I2C port, it is written to the I2C transmit buffer. This buffer is processed in the background, and all data added to it is send via the I2S port. Special "escape sequences" (control characters) are used for putting Start, Stop and Repeated Start conditions on the bus. The '~' is the default "escape character". The "escape sequences" are:</p>
<table class="doxtable">
<tr>
<th>Escape<br/>
 Sequence </th><th>Description  </th></tr>
<tr>
<td><b>~~</b> </td><td>Will cause a single ~ character to be sent on the I2C port </td></tr>
<tr>
<td><b>~s</b> </td><td>Put start on bus. A second 's' character (anywhere in string) before a 'p' character will cause a repeated Start condition </td></tr>
<tr>
<td><b>~p</b> </td><td>Put stop on bus </td></tr>
<tr>
<td><b>~rn</b> </td><td>Read n number of bytes, where n is a value from 0-254. A value of 255 means read till slave does not ACK </td></tr>
</table>
<h2><a class="anchor" id="info_serport_i2c1_read"></a>
Reading I2C Messages, and Write status</h2>
<p>All data received via the I2C bus is written to the I2C receive buffer. Special "escape sequences" are used to indicate what the data is. </p>
<table class="doxtable">
<tr>
<th>Escape<br/>
 Sequence </th><th>Description  </th></tr>
<tr>
<td><b>~eAC</b> </td><td>Status code for a written message, where A is the address of the device written to, and C is the code </td></tr>
<tr>
<td><b>~rAD</b> </td><td>Read data, where A is the address of the slave the data was read from, and D is the data </td></tr>
</table>
<h1><a class="anchor" id="info_serport_i2c1_examples"></a>
Examples</h1>
<p>Following are some examples for communicating with nodes on the I2C 1 Serial Port. <br/>
<b>Writing 0x10 to an I2C node with address 5A</b> <br/>
<code><b>s5A10p</b></code> <br/>
[I2C Start][Address:0x5A][Data:0x10][I2C Stop] <br/>
This commands sends and I2C message, beginning with a I2C Start condition, and ending with an I2C stop condition.</p>
<p><br/>
<b>Writing "Hello" to an I2C node with address 25</b> <br/>
<code><b>s2548656C6C6Fp</b></code> <br/>
[I2C Start][Address:0x5A][Data:0x48, 0x65, 0x6C, 0x6C, ox6F][I2C Stop] <br/>
This commands sends and I2C message, beginning with a I2C Start condition, and ending with an I2C stop condition. The string "Hello" is sent. Each character has to be sent with it's code.</p>
<p><br/>
<b>Reading two bytes from an I2C node with address 51</b> <br/>
<code><b>s5102p</b></code> <br/>
[I2C Start][Address:0x51, R/W = Read][Number of bytes to read: 02][I2C Stop] <br/>
This commands sends and I2C message, beginning with a I2C Start condition, and ending with an I2C stop condition. Two bytes are read from the I2C node with address 0x51 (or 0x50 for reading).</p>
<p><br/>
<b>Repeated Start, write 1 byte (0x15), reading 3 bytes from an I2C node with address 2A (or 2B for writing)</b> <br/>
<code><b>s2A15 s2B03p</b></code> <br/>
[I2C Start][Address:0x2A, R/W = Write][Data: 0x15] [I2C Repeated Start][Address:0x2B, R/W = Read][Number of bytes to read: 03][I2C Stop] <br/>
This commands uses the I2C repeated start feature. If a second start command is sent, without sending a stop command, it will cause a repeated start condition to be put on the I2C 1 Serial Port. A single byte is written to the I2C node with address 0x2A, and 3 bytes are read from the I2C node with address 0x2B. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 1 2013 22:07:52 for Netcruzer by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
