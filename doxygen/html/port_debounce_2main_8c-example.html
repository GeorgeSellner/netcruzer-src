<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Netcruzer Library API: port_debounce/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Netcruzer Library API
   &#160;<span id="projectnumber">V2.03</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('port_debounce_2main_8c-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">port_debounce/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<h2>===== Description =====</h2>
<p>This demo shows how to use the <a class="el" href="nz__debounce_8h.html" title="Contains code for debouncing noisy ditital inputs, like buttons. ">nz_debounce.h</a> and nz_debounce.c files for debouncing noisy digital inputs. For this demo, port 32 and 33 (old port names Y2 and Y3) are used. These <a href="http://netcruzer.com/nzdoc-sbc66-ports">SBC66 Ports</a> are connected to buttons on the <a href="http://netcruzer.com/db66dev1.html">DB66DEV1</a> development daughter board. These 2 buttons will rotate LEDs 1 to 4 left or right. LEDs 1 to 4 are located on IO Ports (ports of SBC) 6, 7, 8 and 9 (old port names X6, X7, X8 and X9) of the DB66DEV1. The following lines in the projdefs.h file specifies what ports are debounced: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#define DEBOUNCE_GET_PORT1()    (!PIN_32)</span></div>
<div class="line"><span class="preprocessor">#define DEBOUNCE_GET_PORT2()    (!PIN_33)</span></div>
</div><!-- fragment --><p>Additionally the System LED blinks every second.</p>
<h2>===== Required Hardware =====</h2>
<p>The project requires a <a href="http://netcruzer.com/products-sbc66-main/">SBC66 Netcruzer board</a>, <b>AND</b> a <a href="http://netcruzer.com/db66dev1.html">DB66DEV1</a> development board. The DB66DEV1 is plugged into the daughter board connector of the SBC66 board. The DB66DEV1 module is however not required, and discrete buttons and LEDs can be connected to the SBC port pins via 1k resistors to 0V.</p>
<h2>===== Building Project =====</h2>
<p>This project is located in the "src/demos/io/port_debounce" folder of the <a href="http://netcruzer.com/nzdownload/" target="_blank">Netcruzer Download</a>. To compile for Netcruzer Board, open this project in MPLAB X, and select the "Project Configuration" for desired board. For example "SBC66ECL_R2" for the <a href="http://netcruzer.com/sbc66ecl.html">SBC66ECL</a> Revision 2 board. For details <a href="http://netcruzer.com/nz/doc/building_projects/" target="_blank">click here</a> A common error is "The system cannot find the path specified". This generally means you don't have the required XC16 compiler version installed. Go to "Project Properties", and select your installed XC16 compiler in the "Project Configuration" section.</p>
<h2>===== Programming Board =====</h2>
<p>After compiling (build), the board can be programmed via the <a href="http://netcruzer.com/nz/doc/update_firmware_usb" target="_blank">USB Bootloader</a> or a <a href="http://netcruzer.com/nz/doc/update_firmware_prog" target="_blank">PIC Programmer</a>. USB Programming is simplified when using the SBC board together with a <a href="http://netcruzer.com/nz/doc/update_firmware_usb_pt66" target="_blank">Prototype Board</a>.</p>
<h2>===== File History =====</h2>
<p>2013-05-03, David H. (DH):</p>
<ul>
<li>Initial version</li>
</ul>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#define THIS_IS_MAIN_FILE   //Uniquely identifies this as the file with the main application entry function main()</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &quot;HardwareProfile.h&quot;</span>    <span class="comment">//Required for all Netcruzer projects</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="nz__db66dev1_8h.html" title="Contains hardware specific defines for DB66DEV1 Revision 1 board. ">nz_db66dev1.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="nz__debounce_8h.html" title="Contains code for debouncing noisy ditital inputs, like buttons. ">nz_debounce.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    BYTE ledRotate = 0x01;</div>
<div class="line">    BYTE ledRotateOld = 0;</div>
<div class="line">    WORD tmrFlashLed = 0;   <span class="comment">//Timer for flashing system LED</span></div>
<div class="line"></div>
<div class="line">    <a name="a0"></a><a class="code" href="nz__netcruzer_8h.html#adfed4b7fa101ade26bd57d654f4c7bcd">nzSysInitDefault</a>();         <span class="comment">//Default initialization. All ports inputs. All analog features disabled. Tick 1ms</span></div>
<div class="line"></div>
<div class="line">    DIR_SYSLED = OUTPUT_PIN;    <span class="comment">//Set System LED port as outputs</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">//Initialize DB66DEV1, all LEDs are output and turned off, Buttons inputs</span></div>
<div class="line">    db66dev1_Init();</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span>(1)</div>
<div class="line">    {</div>
<div class="line">        <a name="a1"></a><a class="code" href="nz__netcruzer_8h.html#ad9122988f6a0fb44a89afca419b66e65">nzSysTaskDefault</a>();     <span class="comment">//Main netcruzer task, call in main loop.</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">//Get debounced port 1, this is defined as PIN_32 in the projdefs.h file.</span></div>
<div class="line">        <span class="keywordflow">if</span> (debounceGetLatchedPort(1)) {</div>
<div class="line">            <span class="comment">//Rotate LEDs 5 to 8 right</span></div>
<div class="line">            ledRotate = ledRotate &gt;&gt; 1;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate==0x0)</div>
<div class="line">                ledRotate = 0x08;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Get debounced port 2, this is defined as PIN_33 in the projdefs.h file.</span></div>
<div class="line">        <span class="keywordflow">if</span> (debounceGetLatchedPort(2)) {</div>
<div class="line">            <span class="comment">//Rotate LEDs 5 to 8 left</span></div>
<div class="line">            ledRotate = ledRotate &lt;&lt; 1;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate==0x10)</div>
<div class="line">                ledRotate = 0x01;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">//Output LEDs</span></div>
<div class="line">        <span class="keywordflow">if</span> (ledRotate != ledRotateOld) {</div>
<div class="line">            ledRotateOld = ledRotate;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate&amp;0x01) LAT_LED5 = 1; <span class="keywordflow">else</span> LAT_LED5 = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate&amp;0x02) LAT_LED6 = 1; <span class="keywordflow">else</span> LAT_LED6 = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate&amp;0x04) LAT_LED7 = 1; <span class="keywordflow">else</span> LAT_LED7 = 0;</div>
<div class="line">            <span class="keywordflow">if</span> (ledRotate&amp;0x08) LAT_LED8 = 1; <span class="keywordflow">else</span> LAT_LED8 = 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">//Flash system LED every 500ms</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a2"></a><a class="code" href="nz__tick_8h.html#a6ba5b7c684a01befa0d9522a7efa880a">tick16TestTmr</a>(tmrFlashLed)) {</div>
<div class="line">            <a name="a3"></a><a class="code" href="nz__tick_8h.html#abd9d8cafb5bb9c655365cebd7bc2bd56">tick16UpdateTmrMS</a>(tmrFlashLed, 500); <span class="comment">//Update timer to expire in 500ms again</span></div>
<div class="line">            LAT_SYSLED = !LAT_SYSLED;       <span class="comment">//Toggle System LED</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    }<span class="comment">//end while</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}<span class="comment">//end main</span></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Dec 9 2014 15:08:18 for Netcruzer Library API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
