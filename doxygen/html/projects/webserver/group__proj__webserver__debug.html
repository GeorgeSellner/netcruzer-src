<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Netcruzer Webserver Project: Debugging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen_proj.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Netcruzer Webserver Project
   &#160;<span id="projectnumber">V1.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__proj__webserver__debug.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Debugging</div>  </div>
</div><!--header-->
<div class="contents">
<p>Debugging can be performed:</p>
<ul>
<li>Using a PIC Programmer/Debugger, like the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__icd3.html">Microchip ICD 3</a>.</li>
<li>Using a Debug Terminal, like the USB port of the board and the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a></li>
</ul>
<h1><a class="anchor" id="proj_webserver_debug_app"></a>
Debug Terminal</h1>
<p>The Debug Terminal is very efficient and easy to use. Just plug your board into a USB port of your PC, and debug messages will be received on the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a>.</p>
<p>The "debug.c" file contains code that implements a Debug Terminal. It's main function is to send and receive debug messages to and from a configurable port. By default it is configured to use the USB HID port of the board, and the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a> (Application running on PC, and connected to board via USB port). This configuration allows the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a> to:</p>
<ul>
<li>Display debug messages received from the board. Throughout the code there are DEBUG_PUT_STR and DEBUG_PUT_WORD macros that send debug message to the debug port (configued to use the USB HID port)</li>
<li>Send messages to the board. These messages are parsed in the debugService() function in "debug.c".</li>
<li>Request information from the board. These requests are also parsed in the debugService() function. For example, entering "ip" in the "Send Debug Text" box of the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a>, and sending it, will result in the board's current IP address to be sent by the board, and displayed in the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a>.</li>
</ul>
<p>All *.c files that want to send debug messages should have the following defined at the top of the file (where XXX is the filename): </p>
<div class="fragment"><div class="line"><span class="comment">//Add debugging to this file. The DEBUG_CONF_XXX macro sets debugging to desired level, and is configured in &quot;Debug Configuration&quot; section of projdefs.h file</span></div>
<div class="line"><span class="preprocessor">#define MY_DEBUG_LEVEL   DEBUG_CONF_XXX</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define  DEBUG_PUT_STR(lvl, str) {if (MY_DEBUG_LEVEL &gt;= lvl) {debugPutString(str);}}</span></div>
<div class="line"><span class="preprocessor">#define  DEBUG_PUT_WORD(lvl, w) {if (MY_DEBUG_LEVEL &gt;= lvl) {debugPutWord(w);}}</span></div>
</div><!-- fragment --><p>The DEBUG_PUT_STR and DEBUG_PUT_WORD macros can then be used to send debug information.</p>
<ul>
<li>The first parameter is the <b>Debug Level</b>, and can be DEBUG_LEVEL_CRITICAL, DEBUG_LEVEL_ERROR, DEBUG_LEVEL_WARNING or DEBUG_LEVEL_INFO. Critical is the highest level.</li>
<li>The second parameter is a string (for DEBUG_PUT_STR) or a WORD (for DEBUG_PUT_WORD)</li>
</ul>
<p>The "Debug Configuration" section in the Hardware Profile file (located in Configs folder, <a class="el" href="_h_w_p___s_b_c66_e_c-_r2_8h_source.html">HWP_SBC66EC-R2.h</a> for example) is used to set the debug level of each file. For example, for the main.c file, the following define will result in only macros with a <b>Debug Level</b> equal to, or higher than, "Warning" to be executed. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#define DEBUG_CONF_MAIN             DEBUG_LEVEL_WARNING</span></div>
</div><!-- fragment --><p> For this example, the following code will result in a debug message being sent to the debug port. </p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../nz__debug_8h.html#aec1c1eaa2fbd5b17bda3241d995a2378">DEBUG_PUT_STR</a>(DEBUG_LEVEL_WARNING, <span class="stringliteral">&quot;\nSomething seems wrong in main.c!&quot;</span>);</div>
</div><!-- fragment --><p> This is the case because we set the <b>Debug Level</b> of DEBUG_CONF_MAIN to warning, meaning all debug messages with Critical, Error or Warning level will be sent. The following message will however not be sent: </p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../nz__debug_8h.html#aec1c1eaa2fbd5b17bda3241d995a2378">DEBUG_PUT_STR</a>(DEBUG_LEVEL_INFO, <span class="stringliteral">&quot;\nSomething interesting happened in main.c!&quot;</span>);</div>
</div><!-- fragment --><p>Additionally the following line in the Hardware Prifile file will disable all debug messages. It is commented by default. For production code, it is a good idea uncommenting this line. This will make the code smaller and faster (no debug messages are sent. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#define DEBUG_LEVEL_ALLOFF</span></div>
</div><!-- fragment --><h1><a class="anchor" id="proj_webserver_debug_details"></a>
Details</h1>
<p>Debugging is implemented in the debug.c file. It provides a simple way for the application to send and receive text based debug messages. The debugPutString() and debugPutWord() functions can be used to write text based debug information to the debug port. The debugGetString() function is used to get the last received debug message.</p>
<p>By default debugging is configured to use the USB HID port, and the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a>. This can be changed if debugging should use some other port, like a Serial Port, UDP or something else.</p>
<p>Using the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a> for debugging is very efficient and easy. The debugService() function in "debug.c" parses strings received from the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a> (entered in the "Send Debug Text" box), and sends a reply debug message. This reply message is displayed in the "Received From Device" message box. To try it, connect the USB port of the board, start the <a class="elRef" doxygen="E:/prj/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_terminal.html">Netcruzer USB Terminal</a>, and enter "ip" in the "Send Debug Text" box. The current IP address should be received from the board, and displayed in the "Received From Device" message box. See example debugService() function in <a class="el" href="ex_debug_service_8c-example.html">ex_debugService.c</a> example file. It shows how to implement two debug commands. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Aug 13 2014 09:12:44 for Netcruzer Webserver Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
