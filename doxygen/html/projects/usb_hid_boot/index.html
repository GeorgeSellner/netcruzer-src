<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Netcruzer USB Bootloader Project: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen_proj.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Netcruzer USB Bootloader Project
   &#160;<span id="projectnumber">V1.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This documentation is for the <em>Netcruzer USB Bootloader</em>. To <b>return to the main Netcruzer documentation page</b> <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../index.html#main_intro">Click Here</a>.</p>
<h1><a class="anchor" id="proj_usbboot_intro"></a>
Introduction</h1>
<p>This documentation contains information on using, configuring and building the <em>Netcruzer USB Bootloader</em>.</p>
<p>For details on programming a board with a pre-built version of the <em>Netcruzer USB Bootloader</em>, <a class="el" href="group__proj__usbboot__update.html">click here</a>. The source code and <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__mplab.html">MPLAB IDE</a> projects is available for free, and located in the ".../src/projects/usb_hid_boot" folder of the <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz__download.html">Netcruzer Download</a>.</p>
<p><br/>
 </p>
<h1><a class="anchor" id="proj_usbboot_detail"></a>
Details</h1>
 
<div class="floatDivR">
    <img src="jmp_f_320.jpg"/>
    <div style="margin:5px;">&nbsp;Picture 1. Jumper in "Firmware Upgrade" position</div>
                                <br><hr>
    <img src="jmp_park_320.jpg"/>
                                <div style="margin:5px;">&nbsp;Picture 2. Jumper in "Park" position</div>
</div>
 All <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../sbc66.html">SBC66 Boards</a> boards with USB ports are programmed at delivery with the <em>Netcruzer USB Bootloader</em>. It is a small program that resides in the first couple of KBytes of program memory, and is activated at startup if the jumper is placed in the "F" position (see Picture 1). It allows the firmware of the board to be updated via the <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_bootloader.html">Netcruzer USB Bootloader</a>. See <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__info__update__usb.html">Updating Firmware via USB</a> for details. Once firmware has been uploaded, the board will have two separate and completely independant programs on it. The <b>Bootloader</b> and <b>Firmware</b> (User Program). See <a class="el" href="index.html#proj_usbboot_mememap">Memory Map</a> for details. When the jumper is placed in the "Park" position (see Picture 2), the <em>Netcruzer USB Bootloader</em> will immediately start the Firmware on power-up.</p>
<p><br/>
 </p>
<h1><a class="anchor" id="proj_usbboot_secure"></a>
Secure Method</h1>
<p>The firmware is updated in a very secure manner. Even a power failure during the firmware update process will not result in the board being programmed with faulty firmware. For details, <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__info__update.html#info_update_details">click here</a>.</p>
<p><br/>
 </p>
<h1><a class="anchor" id="proj_usbboot_sysled"></a>
System LED</h1>
<p>The system LED indicates the state of the board. During normal operation, the LED should have one long, and 1 to 3 short flashes per cycle, depending on the loaded firmware. For example, the Webserver firmware will have one long, and one short LED flash each 1.6 seconds. When in bootloader mode (jumper on "F"), there will always be two long flashes, followed by 1 to 3 short flashes. The state of the bootloader is:</p>
<p><br/>
 </p>
<h3>Bootloader Mode, USB unplugged</h3>
<p>When the board is in bootloader mode, but the USB connection is not active, the LED will have 2 long flashes, followed by 1 short flash every 3.2 seconds. </p>
<table  border="0">
<tr>
<td width="740px" align="center">3.2 Seconds (times below in ms) </td></tr>
</table>
<table class="doxtable">
<tr style="text-align:center; font-family: Arial; font-size:10px; font-weight:bold;">
<td bgcolor="red" width="80px">400 On </td><td bgcolor="gray" width="80px">400 Off </td><td bgcolor="red" width="80px">400 On </td><td bgcolor="gray" width="80px">400 Off </td><td bgcolor="red" width="20px" style="font-size:8px;">100 On </td><td bgcolor="gray" width="300px">1500 Off </td></tr>
</table>
<p>LED flash pattern is 400ms ON, 400ms OFF, 400ms ON, 400ms OFF, 100ms ON, 1500ms OFF.</p>
<p><br/>
 </p>
<h3>Bootloader Mode, USB plugged in</h3>
<p>When the board is in bootloader mode, and the USB port is plugged in and initialized, the LED will have 2 long flashes, followed by 2 short flashes every 3.2 seconds. New firmware can be uploaded via the <a class="elRef" doxygen="C:/netcruzer/doxygen/main.tag:../../" href="../../group__devtools__nz_usb_bootloader.html">Netcruzer USB Bootloader</a> application. </p>
<table  border="0">
<tr>
<td width="740px" align="center">3.2 Seconds (times below in ms) </td></tr>
</table>
<table class="doxtable">
<tr style="text-align:center; font-family: Arial; font-size:10px; font-weight:bold;">
<td bgcolor="red" width="80px">400 On </td><td bgcolor="gray" width="80px">400 Off </td><td bgcolor="red" width="80px">400 On </td><td bgcolor="gray" width="80px">400 Off </td><td bgcolor="red" width="20px" style="font-size:9px;">100 On </td><td bgcolor="gray" width="20px" style="font-size:9px;">100 Off </td><td bgcolor="red" width="20px" style="font-size:8px;">100 On </td><td bgcolor="gray" width="240px">1500 Off </td></tr>
</table>
<p>LED flash pattern is 400ms ON, 400ms OFF, 400ms ON, 400ms OFF, 100ms ON, 200ms OFF, 100ms ON, 1200ms OFF.</p>
<p><br/>
 </p>
<h1><a class="anchor" id="proj_usbboot_mememap"></a>
Memory Map</h1>
<p>There will always be a minimum of two separate programs located on the Microcontrollers FLASH program memory:</p>
<ul>
<li>The <b>Bootloader</b> is a separate program located in the lower 6 KWords of the Microcontrollers FLASH program memory, at word address 0 to 0x1BFF.</li>
<li>The <b>User Program</b> (Firmware) occupies the remaining spaceis a separate program located in the lower 6 KWords of the Microcontrollers FLASH program memory, at word address 0 to 0x1BFF.</li>
</ul>
<p>When the board is powered, the bootloader program will be executed. It will check the jumpers of the board. If the the jumper is in the "Park" position (or removed), the</p>
<table  border="0">
<tr>
<td>&#160;&#160;</td><td><table  border="1" cellspacing="0" cellpadding="3" style="font-family: Courier New; font-weight:bold;">
<tr style="background: lightgray;">
<td rowspan="3">Bootloader </td><td>0x0000 - 0x00FF </td><td>Interrupt Vector Table  </td></tr>
<tr style="background: lightgray;">
<td>0x0100 - 0x01FF </td><td>Alternative Interrupt Vector Table  </td></tr>
<tr style="background: lightgray;">
<td>0x0200 - 0x1BFF </td><td>Bootloader  </td></tr>
<tr>
<td rowspan="2">User Program </td><td>0x1C00 - 0x1D0F </td><td>User Program Interrupt Vector Table  </td></tr>
<tr>
<td>0x1D10 - 0x2A7FF </td><td>User Program  </td></tr>
<tr style="background: lightblue;">
<td>&#160; </td><td>0x2A800 - 0x2ABFF </td><td>Last Page, contains Configuration Words  </td></tr>
</table>
</td></tr>
<tr>
<td>&#160;&#160;</td><td>FLASH Program Memory Map - Word addresses </td></tr>
</table>
<p><br/>
<br/>
<br/>
</p>
<div class="hideElement"> <div class="image">
<img src="mxsecbar18.gif" alt="mxsecbar18.gif"/>
</div>
 <div class="image">
<img src="mxsecbar20.gif" alt="mxsecbar20.gif"/>
</div>
 <div class="image">
<img src="mxsecbar22.gif" alt="mxsecbar22.gif"/>
</div>
 <div class="image">
<img src="jmp_f_320.jpg" alt="jmp_f_320.jpg"/>
</div>
 <div class="image">
<img src="jmp_park_320.jpg" alt="jmp_park_320.jpg"/>
</div>
 </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jul 29 2013 20:51:31 for Netcruzer USB Bootloader Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
